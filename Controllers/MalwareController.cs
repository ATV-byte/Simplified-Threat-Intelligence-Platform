using Microsoft.AspNetCore.Mvc;
using MongoDB.Bson;
using MongoDB.Driver;

[ApiController]
[Route("api/[controller]")]
public class MalwareController : ControllerBase
{
    private readonly IMongoDatabase _db;
    public MalwareController(IMongoDatabase db) => _db = db;

    [HttpGet("test")]
    public async Task<IActionResult> Test()
    {
        var col = _db.GetCollection<BsonDocument>("malware");
        var count = await col.CountDocumentsAsync(FilterDefinition<BsonDocument>.Empty);
        return Ok(new { message = "Mongo connected", malwareCount = count });
    }
}
